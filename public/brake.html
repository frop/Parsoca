    <!DOCTYPE HTML SYSTEM>
    <html>
    <head>
    <title>Brakeman Report</title>
    <script type="text/javascript">
      function toggle(context) {
        var elem = document.getElementById(context);

        if (elem.style.display != "block")
          elem.style.display = "block";
        else
          elem.style.display = "none";
          
        elem.parentNode.scrollIntoView();
      }
    </script>
    <style type="text/css"> 
    /* CSS style used for HTML reports */

body {
  font-family: sans-serif;
  color: #161616;
}

p {
  font-weight: bold;
  font-size: 11pt;
  color: #2D0200;
 }

 th {
   background-color: #980905;
   border-bottom: 5px solid #530200;
   color: white;
   font-size: 11pt;
   padding: 1px 8px 1px 8px;
 }

 td {
   border-bottom: 2px solid white;
   font-family: monospace;
   padding: 5px 8px 1px 8px;
 }

 table {
   background-color: #FCF4D4;
   border-collapse: collapse;
 }

 h1 {
   color: #2D0200;
   font-size: 14pt;
 }

 h2 {
   color: #2D0200;
   font-size: 12pt;
 }

 span.high-confidence {
   font-weight:bold;
   color: red;
 }

 span.med-confidence {
 }

 span.weak-confidence {
   color:gray;
 }

 div.warning_message {
   cursor: pointer;
 }

 div.warning_message:hover {
   background-color: white;
 }

 table caption {
   background-color: #FFE;
   padding: 2px;
 }

 table.context {
   margin-top: 5px;
   margin-bottom: 5px;
   border-left: 1px solid #90e960;
   color: #212121;
 }

 tr.context {
   background-color: white;
 }

 tr.first {
   border-top: 1px solid #7ecc54;
   padding-top: 2px;
 }

 tr.error {
  background-color: #f4c1c1 !important
 }

 tr.near_error {
  background-color: #f4d4d4 !important
 }

 tr.alt {
   background-color: #e8f4d4;
 }

 td.context {
   padding: 2px 10px 0px 6px;
   border-bottom: none;
 }

 td.context_line {
   padding: 2px 8px 0px 7px;
   border-right: 1px solid #b3bda4;
   border-bottom: none;
   color: #6e7465;
 }

 pre.context {
   margin-bottom: 1px;
 }

    </style>
    </head>
    <body>
    <h1>Brakeman Report</h1>
    <table>
      <tr>
        <th>Application Path</th>
        <th>Rails Version</th>
        <th>Report Generation Time</th>
        <th>Checks Performed</th>
      </tr>
      <tr>
        <td>/home/ubuntu/ror/parsoca</td>
        <td>3.2.1</td>
        <td>2012-03-09 14:25:56 +0000</td>
        <td>BasicAuth, CrossSiteScripting, DefaultRoutes, EscapeFunction, Evaluation, Execute, FileAccess, FilterSkipping, ForgerySetting, LinkTo, LinkToHref, MailTo, MassAssignment, ModelAttributes, NestedAttributes, QuoteTableName, Redirect, Render, ResponseSplitting, SQL, SafeBufferManipulation, SelectVulnerability, SendFile, SessionSettings, SkipBeforeFilter, StripTags, TranslateBug, ValidationRegex, WithoutProtection</td>
      </tr>
     </table>
<h2 id='summary'>Summary</h2>	<table>
		<tr>
			<th>Scanned/Reported</th>
			<th>Total</th>
		</tr>
		<tr>
			<td>Controllers</td>
			<td>3</td>
		</tr>
		<tr>
			<td>Models</td>
			<td>2</td>
		</tr>
		<tr>
			<td>Templates</td>
			<td>23</td>
		</tr>
		<tr>
			<td>Errors</td>
			<td>0</td>
		</tr>
		<tr>
			<td>Security Warnings</td>
			<td>6 <span class='high-confidence'>(3)</span></td>
		</tr>
	</table>
<br/>	<table>
		<tr>
			<th>Warning Type</th>
			<th>Total</th>
		</tr>
		<tr>
			<td>Attribute Restriction</td>
			<td>1</td>
		</tr>
		<tr>
			<td>Cross Site Scripting</td>
			<td>1</td>
		</tr>
		<tr>
			<td>Mass Assignment</td>
			<td>2</td>
		</tr>
		<tr>
			<td>Redirect</td>
			<td>2</td>
		</tr>
	</table>
<h2>Security Warnings</h2>	<table>
		<tr>
			<th>Confidence</th>
			<th>Class</th>
			<th>Method</th>
			<th>Warning Type</th>
			<th>Message</th>
		</tr>
		<tr>
			<td><span class='high-confidence'>High</span></td>
			<td>IntervalsController</td>
			<td>create</td>
			<td>Mass Assignment</td>
			<td><div class='warning_message' onClick="toggle('context1');toggle('message1');toggle('full_message1')" >Unprotected mass assignment near line 50: Interval.new(params[:interval])<table id='context1' class='context' style='display:none'><caption>/app/controllers/intervals_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>45</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /intervals</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /intervals.json</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @interval = Interval.new(params[:interval])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @interval.user = current_user</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @interval.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @interval, notice: 'Interval was successfully created.' }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { render json: @interval, status: :created, location: @interval }</pre>
            </td>
          </tr>
</table></div></td>
		</tr>
		<tr>
			<td><span class='high-confidence'>High</span></td>
			<td>IntervalsController</td>
			<td>update</td>
			<td>Mass Assignment</td>
			<td><div class='warning_message' onClick="toggle('context2');toggle('message2');toggle('full_message2')" ><span id='message2' style='display:block' >Unprotected mass assignment near line 69: Interval.find(params[:id]).update_attributes(params[:interv...</span><span id='full_message2' style='display:none'>Unprotected mass assignment near line 69: Interval.find(params[:id]).update_attributes(params[:interval])</span><table id='context2' class='context' style='display:none'><caption>/app/controllers/intervals_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>64</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /intervals/1.json</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @interval = Interval.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @interval.update_attributes(params[:interval])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @interval, notice: 'Interval was successfully updated.' }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>71</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { head :no_content }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>72</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>73</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render action: &quot;edit&quot; }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>74</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { render json: @interval.errors, status: :unprocessable_entity }</pre>
            </td>
          </tr>
</table></div></td>
		</tr>
		<tr>
			<td><span class='med-confidence'>Medium</span></td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
			<td>Cross Site Scripting</td>
			<td>Rails 3.2.1 has a vulnerabilty in SafeBuffer. Upgrade to 3.2.2 or apply patches.</td>
		</tr>
		<tr>
			<td><span class='weak-confidence'>Weak</span></td>
			<td>IntervalsController</td>
			<td>update</td>
			<td>Redirect</td>
			<td><div class='warning_message' onClick="toggle('context3');toggle('message3');toggle('full_message3')" ><span id='message3' style='display:block' >Possible unprotected redirect near line 70: redirect_to(Interval.find(params[:id]), :notice =&gt; &quot;Inter...</span><span id='full_message3' style='display:none'>Possible unprotected redirect near line 70: redirect_to(Interval.find(params[:id]), :notice =&gt; &quot;Interval was successfully updated.&quot;)</span><table id='context3' class='context' style='display:none'><caption>/app/controllers/intervals_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>65</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def update</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @interval = Interval.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @interval.update_attributes(params[:interval])</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @interval, notice: 'Interval was successfully updated.' }</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>71</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { head :no_content }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>72</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>73</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render action: &quot;edit&quot; }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>74</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { render json: @interval.errors, status: :unprocessable_entity }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>75</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
</table></div></td>
		</tr>
		<tr>
			<td><span class='weak-confidence'>Weak</span></td>
			<td>UsersController</td>
			<td>update</td>
			<td>Redirect</td>
			<td><div class='warning_message' onClick="toggle('context4');toggle('message4');toggle('full_message4')" ><span id='message4' style='display:block' >Possible unprotected redirect near line 64: redirect_to(User.find(params[:id]), :notice =&gt; &quot;User was ...</span><span id='full_message4' style='display:none'>Possible unprotected redirect near line 64: redirect_to(User.find(params[:id]), :notice =&gt; &quot;User was successfully updated.&quot;)</span><table id='context4' class='context' style='display:none'><caption>/app/controllers/users_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>59</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def update</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @user = User.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @user.update_attributes(params[:user])</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @user, notice: 'User was successfully updated.' }</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { head :no_content }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render action: &quot;edit&quot; }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { render json: @user.errors, status: :unprocessable_entity }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
</table></div></td>
		</tr>
	</table>
	<p>Model Warnings</p>
	<table>
		<tr>
			<th>Confidence</th>
			<th>Model</th>
			<th>Warning Type</th>
			<th>Message</th>
		</tr>
		<tr>
			<td><span class='high-confidence'>High</span></td>
			<td>Interval</td>
			<td>Attribute Restriction</td>
			<td>Mass assignment is not restricted using attr_accessible</td>
		</tr>
	</table>
</body></html>
